function checkAddr(a){if("000000"==province_value){addr_value="000000";addr=""}else{if("000000"==city_value){addr_value=province_value;addr=provinces[provinces_map[province_value]].label}else{if("000000"==district_value){addr_value=province_value+city_value;addr=provinces[provinces_map[province_value]].label+citys[citys_map[city_value]].label}else{addr_value=province_value+city_value+district_value;addr=provinces[provinces_map[province_value]].label+citys[citys_map[city_value]].label+districts[districts_map[district_value]].label;if(""!=a){addr+=a}}}}}function initBusinessElement(){var a=$("#business-pictures").attr("data-pictures");if(""!=a){pictures_array=a.split(";");for(var c in pictures_array){var d=pictures_array[c];if(d){var b='<img src="'+d+'" class="origin_image">';$("#business-pictures").append(b)}}}}function appendBusinessesElement(l){for(var g in l){var d=l[g][0];var a=l[g][1];var m=l[g][2];var j=l[g][3];var h=l[g][4];var c=l[g][5];var b=l[g][6];var k=l[g][7];var n=l[g][8];if(k){var f=k.split(";")[0]}else{var f="/static/common/img/business_no_picture.jpg"}var e='<div class="1List-item" style="position: relative;">        <div class="ContentItem">        <div class="ContentItem-left" style="width:100px;padding:10px 15px;float:left;"><a href="/business/'+d+'/" target="_blank"><img class="" style="width:100px;height:75px;" src="'+f+'" alt=""></a></div>        <div class="ContentItem-ritht" style="padding:10px 10px 15px 10px;">        <div style="font-size:14px;color:#25d;padding:5px;"><a href="/business/'+d+'/" target="_blank">'+a+'</a></div>        <div style="font-size:12px;color:#666;overflow: hidden;white-space: nowrap;">'+m+'</div>        <div class="ContentItem-status">        <span class="ContentItem-statusItem" style="font-size:12px;">'+h+'</span>        <span class="ContentItem-statusItem" style="font-size:12px;">'+getDateDiff(n)+"</span>        </div>        </div>        </div>        </div>";$("#appendArea").append(e)}}function checkSelectDistrict(){$(".select-district").off("click");$(".select-district").each(function(){$(this).click(function(){$(".select.select-district").removeClass("select");$(this).addClass("select");district_value=$(this).attr("data-addr-value");checkAddrGetBusinessData()})})}function checkSelectCity(){$(".select-city").off("click");$(".select-city").each(function(){$(this).click(function(){$(".select.select-city").removeClass("select");$(this).addClass("select");city_value=$(this).attr("data-addr-value");$("#districts").empty().append('<a class="select select-district" href="javascript:;" data-addr-value="000000">全部</a>');if("000000"!=city_value){districts=citys[citys_map[city_value]].children;for(i in districts){var c=districts[i];var b=c.value;var a=c.label;var d='<a class="select-district" href="javascript:;" data-addr-value='+b+">"+a+"</a>";$("#districts").append(d);districts_map[b]=i}checkSelectDistrict()}checkAddrGetBusinessData()})})}function checkSelectProvince(){$(".select-province").off("click");$(".select-province").each(function(){$(this).click(function(){$(".select.select-province").removeClass("select");$(this).addClass("select");province_value=$(this).attr("data-addr-value");$("#citys").empty().append('<a class="select select-city" href="javascript:;" data-addr-value="000000">全部</a>');$("#districts").empty().append('<a class="select select-district" href="javascript:;" data-addr-value="000000">全部</a>');if("000000"!=province_value){citys=provinces[provinces_map[province_value]].children;for(i in citys){var c=citys[i];var b=c.value;var a=c.label;var d='<a class="select-city" href="javascript:;" data-addr-value='+b+">"+a+"</a>";$("#citys").append(d);citys_map[b]=i}checkSelectCity()}checkAddrGetBusinessData()})})}function checkAddrGetBusinessData(){checkAddr("");$("#appendArea").empty();g_last_getmoredata_index=0;getMoreData()}function checkBusinessesKeyword(){$("#businessSearchButton").click(function(){var a=$("#businessSearchInput").val();business_keyword=a.replace(/[^\a-\z\A-\Z0-9\u4E00-\u9FA5]/g,"");console.log(a);$("#appendArea").empty();g_last_getmoredata_index=0;getMoreData()})}function checkBusinessesTypeTab(){$(".Businesses-tabs .Tabs-link").off("click");$(".Businesses-tabs .Tabs-link").on("click",function(){$(".Businesses-tabs .Tabs-link").removeClass("is-active");$(this).addClass("is-active");g_business_type=$(this).attr("data-business-type");$("#appendArea").empty();g_last_getmoredata_index=0;getMoreData()})}function initBusinessesElement(){provinces=getProvinces();provinces_map={};citys_map={};districts_map={};province_value=city_value=district_value="000000";addr="";addr_value="000000";business_keyword="";for(i in provinces){var a=provinces[i];var c=a.value;var b=a.label;var d='<a class="select-province" href="javascript:;" data-addr-value='+c+">"+b+"</a>";$("#provinces").append(d);provinces_map[c]=i}checkSelectProvince();checkBusinessesTypeTab();checkBusinessesKeyword()}function initBusinessPostProvinces(){provinces=getProvinces();provinces_map={};citys_map={};districts_map={};province_value=city_value=district_value="000000";addr="";addr_value="000000";for(i in provinces){var a=provinces[i];var c=a.value;var b=a.label;var d='<option value="'+c+'">'+b+"</option>";$("#province_select").append(d);provinces_map[c]=i}}function initBusinessPostElement(){initBusinessPostProvinces();checkBusinessPost()}function appendBusinessPostPicture(b){console.log(b);var a='<div class="BusinessPicture" style="float:left"><img style="padding:5px;width:72px;height:48px;" src="'+b+'" alt=""><div style="padding-left:30px;font-size:14px;color:red;"><button class="business-picture-delete" type="button">删除</button></div</span>';$("#business-pictures").append(a);$(".business-picture-delete").off("click");$(".business-picture-delete").on("click",function(){$(this).parents(".BusinessPicture").remove()})}function checkBusinessPost(){var k="";var e="";var j="";var f="";var c="";var h="";function d(){$("#province_select").on("change",function(){$("#town input").attr("disabled","true").val("");province_value=$("#province_select option:selected").attr("value");l();city_value=district_value="000000";$("#city_select").empty().append('<option value="000000">请选择城市（全部）</option>');$("#district_select").empty().append('<option value="000000">请选择地区（全部）</option>');if("000000"==province_value){return}citys=provinces[provinces_map[province_value]].children;for(i in citys){var o=citys[i];var n=o.value;var m=o.label;var p='<option value="'+n+'">'+m+"</option>";$("#city_select").append(p);citys_map[n]=i}});$("#city_select").on("change",function(){$("#town input").attr("disabled","true").val("");city_value=$("#city_select option:selected").attr("value");district_value="000000";$("#district_select").empty().append('<option value="000000">请选择城市（全部）</option>');if("000000"==city_value){return}districts=citys[citys_map[city_value]].children;for(i in districts){var o=districts[i];var n=o.value;var m=o.label;var p='<option value="'+n+'">'+m+"</option>";$("#district_select").append(p);districts_map[n]=i}});$("#district_select").on("change",function(){$("#town input").attr("disabled","true").val("");district_value=$("#district_select option:selected").attr("value");if("000000"!=district_value){$("#town input").removeAttr("disabled")}})}function l(){if((""!=k)&&(""!=f)&&("000000"!=province_value)){$(".BusinessPost").removeAttr("disabled")}else{$(".BusinessPost").attr("disabled","")}}function g(){$(".BusinessPost-title textarea").on("input",function(){k=$("textarea[name='title']").val();l()})}function a(){$(".BusinessPost-detail textarea").on("input",function(){e=$("textarea[name='detail']").val()})}function b(){$(".BusinessPost-contact textarea").on("input",function(){f=$("textarea[name='contact']").val();l()})}$("#business-picture-select").click(function(){$("#business-picture-input").click()});$("#business-picture-input").on("change",function(){scaleAndUploadImage("forBusiness",this.files[0],720)});$(".BusinessPost").click(function(){j=$("input[name='type']").val();if(k.length>LITTLE_TEXT_MAX_LENGTH){k=k.substr(0,LITTLE_TEXT_MAX_LENGTH-1);$("textarea[name='title']").val(k)}if(e.length>MIDDLE_TEXT_MAX_LENGTH){e=e.substr(0,MIDDLE_TEXT_MAX_LENGTH-1);$("textarea[name='detail']").val(e)}h=$("input[name='town']").val();checkAddr(h);c="";$(".BusinessPicture img").each(function(){c+=$(this).attr("src")+";"});$("input[name='addr']").val(addr);$("input[name='addr_value']").val(addr_value);$("input[name='pictures']").val(c);$(this).closest("form").submit()});d();g();a();b()};